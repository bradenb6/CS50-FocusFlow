{% extends "layout.html" %}

{% block title %}Tasks{% endblock %}

{% block content %}
<div class="tasks-container">

    <!-- add task button is added to the top -->
    <div class="center-btn">
        <button class="toggle-form-btn" onclick="toggleTaskForm()">Add Task +</button>
    </div>

    <!-- add task form that asks for a task, description, and deadline -->
    <div id="task-form" class="task-form hidden">
        <form action="/tasks" method="POST">

            <label>Task</label>
            <input type="text" name="title" required>

            <label>Description</label>
            <textarea name="description" rows="3" required></textarea>

            <label>Deadline</label>
            <input type="date" name="deadline" required>

            <button type="submit" class="save-btn">Add Task</button>
        </form>
    </div>

    <!-- list of tasks using jinja to display it  -->
    <div class="tasks-list">
        <h2>Your Tasks</h2>

        <!-- checks if there is any tasks to display -->
        {% if tasks %}
        <ul class="task-list">

            <!-- displays the tasks -->
            {% for t in tasks %}
            <li class="task-item">
                <strong>{{ t["title"] }}</strong>
                <p>{{ t["description"] }}</p>
                <span class="deadline">Deadline: {{ t["deadline"] }}</span>

                <!-- adds the edit button and gives the data to the edit function -->
                <div class="task-buttons">
                    <button class="edit-btn"
                        onclick="openEditModal(
                            {{ t['id'] }},
                            '{{ t['title']|escape }}',
                            '{{ t['description']|escape }}',
                            '{{ t['deadline'] }}'
                        )">
                        Edit
                    </button>

                    <!-- adds the delete button -->
                    <form method="POST" action="/tasks/delete/{{ t['id'] }}">
                        <button class="delete-btn" type="submit">Delete</button>
                    </form>
                </div>
            </li>
            {% endfor %}

        </ul>

        <!-- if no taskts, shows this -->
        {% else %}
        <p class="no-tasks">No tasks added yet.</p>
        {% endif %}
    </div>

</div>

<!-- edit modal that lets the user update the information in the tasks -->
<div id="edit-modal" class="modal hidden">
    <div class="modal-content">
        <h2>Edit Task</h2>

        <form id="edit-form" method="POST">
            <label>Task</label>
            <input type="text" name="title" id="edit-title" required>

            <label>Description</label>
            <textarea name="description" id="edit-description" rows="3" required></textarea>

            <label>Deadline</label>
            <input type="date" name="deadline" id="edit-deadline" required>

            <div class="modal-buttons">
                <button class="save-btn" type="submit">Save Changes</button>
                <button type="button" class="cancel-btn" onclick="closeEditModal()">Cancel</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

<!-- connects this to tasks.js -->
{% block scripts %}
<script src="{{ url_for('static', filename='tasks.js') }}"></script>

{% endblock %}
