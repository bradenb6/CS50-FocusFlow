{% extends "layout.html" %}

{% block title %}Goals{% endblock %}

{% block content %}
    <div class="goals-container">

        <!-- adds the Add Goal button in the center of the screen -->
        <div class="center-btn">
            <button class="toggle-form-btn" onclick="toggleGoalForm()">Add Goal +</button>
        </div>

        <!-- adds the form for the goals that is originally hidden and lets users input the goal, a description, and a deadline -->
        <div id="goal-form" class="goal-form hidden">
            <form action="{{ url_for('goals') }}" method="POST">
                <label>Goal</label>
                <input type="text" name="goal" required>

                <label>Description</label>
                <textarea name="description" rows="3" required></textarea>

                <label>Deadline</label>
                <input type="date" name="deadline" required>

                <button type="submit" class="save-btn">Add Goal</button>
            </form>
        </div>

        <!-- shows each of the goals using a jinja loop to show each goal with the title bolded, a description underneath and buttons -->
        <div class="goals-list">
            <h2>Your Goals</h2>

            {% if goals %}
                <ul class="goal-list">
            {% for goal in goals %}
                <li class="goal-item">
                    <strong>{{ goal["title"] }}</strong>
                    <p>{{ goal["description"] }}</p>
                    <span class="deadline">Deadline: {{ goal["deadline"] }}</span>

                    <!-- adds the edit and delete button for each goal -->
                    <div class="goal-buttons">
                        <div class="goal-buttons">
                        <button class="edit-btn"
                            onclick="openEditModal(
                                {{ goal['id'] }},
                                '{{ goal['title']|escape }}',
                                '{{ goal['description']|escape }}',
                                '{{ goal['deadline'] }}'
                            )">
                            Edit
                        </button>

                            <!-- delete button -->
                        <form method="POST" action="/goals/delete/{{ goal['id'] }}">
                            <button class="delete-btn" type="submit">Delete</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
            </ul>
            <!-- if there were no goals to add, this is displayed -->
            {% else %}
                <p class="no-goals">No goals added yet.</p>
            {% endif %}
        </div>
        <!-- builds the edit modal that pops up when edit is clicked, hidden elsewise  -->
        <div id="edit-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Edit Goal</h2>

            <form id="edit-form" method="POST">
                <label>Goal: </label>
                <input type="text" name="goal" id="edit-title" required>

                <label>Description: </label>
                <textarea name="description" id="edit-description" rows="3" required></textarea>

                <label>Deadline: </label>
                <input type="date" name="deadline" id="edit-deadline" required>

                <button type="submit">Save Changes</button>
                <button type="button" class="close-modal" onclick="closeEditModal()">Cancel</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

<!-- connects this page to goals.js -->
{% block scripts %}
    <script src="{{ url_for('static', filename='goals.js') }}"></script>
{% endblock %}
